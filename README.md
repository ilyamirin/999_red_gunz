## Установка

### Установка виртульного окружения и активация

```commandline
$ pip install virtualenv
$ python3 -m venv env
$ source env/bin/activate
```

### Установка необходимых библиотек

```commandline
$ pip install -r requirements.txt
```

### Настройка config.txt

Первая строка - адрес на котором запускается веб хук. (По умолчанию localhost)

Вторая строка - порт на котором запускается веб хук

Третья строка - Публичный адрес, с которым телеграм связывает вебхук (в примере адрес от ngrok)

Четвертая строка - id а телеграме администратора (только этот id сможет пользоваться командой /add_bill) 
. Узнать свой id можно у бота @userinfobot.

Пятая строка - токен бота. (В примере стоит токен моего бота. По желанию его можно изменить)

```text
localhost
5000
https://a8ea148a9a8b.ngrok.io
1065927973
1134509917:AAGn7ZGVdp_fNQ0BsM0rxfWdCruAr0viAhM

```


### Настройка db_config.txt

Первая строка - имя пользователя БД

Вторая строка - пароль пользователя БД

Третья строка - хост на котором запущена БД (Для локальной бд localhost)

Четвертая строка - имя созданной базы данных для бота

Пример:

```text
user_bot
qwerty123
localhost
bot_database
```

## Запуск бота

```commandline
$ python3 bot.py
```

## Описание команд

### /start
Если введена первый раз, начнется диалог с выбором региона. Необходимо ввести регион в точности как в файле regions.txt, либо отказаться от ввода региона.
 
### /get_bill
Сначала будет выполнен поиск в базе данных законопроекта, на который пользователь не отвечал. Если такой есть, то
начнется диалог, в котором пользователь должен проголосовать за предоставленный законопроект. Если 
пользователь не указывал свой регион, то информации по депутатам определенного региона не будет.

### /add_bill

__Команда только для администратора__

После ввода данной команды будет предложено передать несколько файлов, количество которых будет варьироваться от значения 
полей IS_NOTE, IS_PDF, IS_SECRET (описание форматов передаваемых фалов в папке example).
Для отмены добавления законопроекта в конце введите /cancel. Также отмена добавления законопроекта произойдет, если формат передаваемых фалов будет неправильным.


### Тест бота с помощью ngrok

В папке проекта:

```consoletext
$ ./ngrok http localhost 5000
```

(Если указывается localhost, то в config.txt тоже должен быть localhost. Аналогично и порты должны совпадать)
Затем после запуска тоннеля необходимо в config.txt на 3-ей строке изменть адрес на __https__ ссылку в терминале с ngrok.

После этого запускать бота:
```commandline
$ python3 bot.py
```
